# LLM Models Guide

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤—ã–±–æ—Ä—É –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é LLM –º–æ–¥–µ–ª–µ–π –≤ Telegram Lead Monitor.

## üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **LiteLLM Proxy** (llm.codenrock.com) - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ 100+ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º —á–µ—Ä–µ–∑ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ .env

```env
LLM_API_URL=https://llm.codenrock.com
LLM_API_KEY=sk-litellm-5d72bc9cb76846620c011e7708fcf4c9
LLM_MODEL=gpt-5-mini
LLM_TIMEOUT=120
```

---

## üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏

### OpenAI (Primary)

| Model | Context | Cost (input/output per 1K) | Best For |
|-------|---------|---------------------------|----------|
| **gpt-5-mini** ‚≠ê | 400K | $0.00075 / $0.003 | **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: –õ—É—á—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ª–∏–¥–æ–≤ |
| gpt-4o-mini | 128K | $0.00015 / $0.0006 | –ë—ã—Å—Ç—Ä—ã–µ –∏ –¥–µ—à–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| gpt-4o | 128K | $0.002 / $0.006 | –°–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑, —Ç—Ä–µ–±—É—é—â–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ |

### Anthropic (Secondary)

| Model | Context | Cost (input/output per 1K) | Best For |
|-------|---------|---------------------------|----------|
| claude-sonnet-4 | 200K | $0.003 / $0.015 | –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞, –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã |
| claude-opus-4.1 | 200K | $0.015 / $0.075 | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–¥–æ—Ä–æ–≥–æ) |

### Google (Tertiary)

| Model | Context | Cost (input/output per 1K) | Best For |
|-------|---------|---------------------------|----------|
| gemini-2.5-pro | 2M | $0.00125 / $0.005 | –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã, –±–æ–ª—å—à–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç |
| gemini-2.0-flash | 1M | $0.000075 / $0.0003 | –°–∞–º–∞—è –¥–µ—à–µ–≤–∞—è –æ–ø—Ü–∏—è |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É

### –î–ª—è production (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```env
LLM_MODEL=gpt-5-mini
```
**–ü–æ—á–µ–º—É:**
- –û—Ç–ª–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ
- –ë–æ–ª—å—à–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (400K —Ç–æ–∫–µ–Ω–æ–≤)
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ fallback —Ü–µ–ø–æ—á–µ–∫

### –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –±—é–¥–∂–µ—Ç–∞
```env
LLM_MODEL=gpt-4o-mini
```
**–ü–æ—á–µ–º—É:**
- –°–∞–º—ã–π –¥–µ—à–µ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ä–µ–¥–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- –ë—ã—Å—Ç—Ä–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∞–≤–∏–ª

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
```env
LLM_MODEL=gpt-4o
```
**–ü–æ—á–µ–º—É:**
- –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
- –ú–µ–Ω—å—à–µ false positives

### –î–ª—è –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
```env
LLM_MODEL=gemini-2.5-pro
```
**–ü–æ—á–µ–º—É:**
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ 2M —Ç–æ–∫–µ–Ω–æ–≤
- –ú–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ü–µ–ª—ã–µ –∞—Ä—Ö–∏–≤—ã –ø–µ—Ä–µ–ø–∏—Å–æ–∫
- –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞

---

## üîÑ Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

–ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –ø—Ä–æ–∫—Å–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è:

```
gpt-5-mini ‚Üí gpt-4o ‚Üí claude-opus-4.1 ‚Üí gemini-2.5-pro
gpt-4o ‚Üí gpt-4o-mini ‚Üí claude-sonnet-4 ‚Üí gemini-2.0-flash
```

**–†–µ—Ç—Ä–∞–∏:** 3 –ø–æ–ø—ã—Ç–∫–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `llm_service.py`)

---

## üí∞ –û—Ü–µ–Ω–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏

### –ü—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞ 1 —Å–æ–æ–±—â–µ–Ω–∏—è:
- **–í—Ö–æ–¥–Ω–æ–π –ø—Ä–æ–º–ø—Ç**: ~300 —Ç–æ–∫–µ–Ω–æ–≤ (—Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç + –ø—Ä–∞–≤–∏–ª–æ + —Å–æ–æ–±—â–µ–Ω–∏–µ)
- **–í—ã—Ö–æ–¥–Ω–æ–π JSON**: ~100 —Ç–æ–∫–µ–Ω–æ–≤

**–°—Ç–æ–∏–º–æ—Å—Ç—å —Å gpt-5-mini:**
- Input: 300 √ó $0.00075 / 1000 = $0.000225
- Output: 100 √ó $0.003 / 1000 = $0.0003
- **–ò—Ç–æ–≥–æ: ~$0.0005 –∑–∞ –∞–Ω–∞–ª–∏–∑**

### –û—Ü–µ–Ω–∫–∞ –¥–ª—è 10,000 –ª–∏–¥–æ–≤ –≤ –º–µ—Å—è—Ü:
- **gpt-5-mini**: ~$5.25/–º–µ—Å—è—Ü
- **gpt-4o-mini**: ~$1.05/–º–µ—Å—è—Ü
- **gpt-4o**: ~$14/–º–µ—Å—è—Ü
- **claude-sonnet-4**: ~$21/–º–µ—Å—è—Ü

---

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ê–Ω–∞–ª–∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª—É

```python
from app.services.llm_service import llm_service

result = await llm_service.analyze_message(
    message_text="–ò—â—É Python —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞–ø–∞",
    rule_description="–ù–∞–π—Ç–∏ –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–ª—è Python —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤"
)

# result:
# {
#     "is_match": True,
#     "confidence": 0.95,
#     "reasoning": "–°–æ–æ–±—â–µ–Ω–∏–µ —è–≤–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–∫–∞–Ω—Å–∏—é –¥–ª—è Python —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞"
# }
```

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π

```python
entities = await llm_service.extract_entities(
    message_text="–ò—â—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞. –ë—é–¥–∂–µ—Ç 150k/–º–µ—Å. –ü–∏—à–∏—Ç–µ @username"
)

# entities:
# {
#     "contacts": ["@username"],
#     "keywords": ["—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫"],
#     "budget": "150k/–º–µ—Å",
#     "deadline": None,
#     "summary": "–ü–æ–∏—Å–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å –±—é–¥–∂–µ—Ç–æ–º 150k –≤ –º–µ—Å—è—Ü"
# }
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∞–º–º–∞—Ä–∏

```python
summary = await llm_service.generate_summary(
    message_text="–î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è...",
    max_length=150
)
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –í –∫–æ–¥–µ (llm_service.py)

```python
# –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (0.0 - 2.0)
# - 0.1-0.3: –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞)
# - 0.7-0.9: –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞)
temperature=0.2

# –ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
max_tokens=300
```

### Temperature guide:
- **0.1-0.2**: –ê–Ω–∞–ª–∏–∑ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º (—Ç–æ—á–Ω–æ—Å—Ç—å)
- **0.3-0.5**: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π (–±–∞–ª–∞–Ω—Å)
- **0.7-1.0**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏–π (–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å)

---

## üö® Rate Limits

### NGINX Ingress (–≤–Ω–µ—à–Ω–∏–π)
- **100 RPS** per IP address
- **Burst**: –¥–æ 500 RPS –≤ –ø–∏–∫–æ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

### LiteLLM Internal
- **1000 RPM** per model (requests per minute)
- **3 retries** —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- **10 –º–∏–Ω—É—Ç** timeout –Ω–∞ –∑–∞–ø—Ä–æ—Å

---

## üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ LiteLLM Proxy: [llm.codenrock.com.md](./llm.codenrock.com.md)

### –ü–æ–ª–µ–∑–Ω—ã–µ endpoint'—ã:
- **Health**: https://llm.codenrock.com/health/readiness
- **Models List**: https://llm.codenrock.com/models
- **Usage Stats**: https://llm.codenrock.com/usage
- **Admin UI**: https://llm.codenrock.com/ui

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–í–ê–ñ–ù–û:**
- API –∫–ª—é—á —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è production
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª—ã –≤ git
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ CI/CD
- –ù–µ –¥–µ–ª–∏—Ç–µ—Å—å `LITELLM_MASTER_KEY` –ø—É–±–ª–∏—á–Ω–æ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

–ß—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥—É—é –º–æ–¥–µ–ª—å:

```bash
# 1. –û–±–Ω–æ–≤–∏—Ç–µ .env
LLM_MODEL=claude-sonnet-4

# 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend
docker-compose restart backend

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
make backend

# 4. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í –ª–æ–≥–∞—Ö backend

```bash
make backend

# –í—ã —É–≤–∏–¥–∏—Ç–µ:
# LLM API call successful. Tokens used: {'prompt_tokens': 285, 'completion_tokens': 78}
```

### Admin UI

–û—Ç–∫—Ä–æ–π—Ç–µ https://llm.codenrock.com/ui:
- Login: admin
- Password: sk-litellm-5d72bc9cb76846620c011e7708fcf4c9

–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å:
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –º–æ–¥–µ–ª—è–º
- –°—Ç–æ–∏–º–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –û—à–∏–±–∫–∏ –∏ fallback'–∏

---

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞—á–Ω–∏—Ç–µ —Å `gpt-5-mini` –¥–ª—è production, —ç—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ! üöÄ
